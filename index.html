<!DOCTYPE html>
<html lang="vi">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
        <title>Happy 5 Months ‚ù§Ô∏è</title>
        <link rel="preconnect" href="https://fonts.googleapis.com" />
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
        <link
            href="https://fonts.googleapis.com/css2?family=Noto+Color+Emoji&family=Pacifico&family=Roboto:wght@400;600&display=swap"
            rel="stylesheet"
        />
        <style>
            * {
                margin: 0;
                padding: 0;
                box-sizing: border-box;
                -webkit-tap-highlight-color: transparent;
            }

            body {
                font-family: 'Roboto', 'Noto Color Emoji', sans-serif;
                font-weight: 400;
                background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
                background-attachment: fixed;
                min-height: 100vh;
                overflow-x: hidden;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
                /* iOS optimizations */
                -webkit-overflow-scrolling: touch;
                overscroll-behavior: none;
            }

            .page {
                display: none;
                min-height: 100vh;
                padding: 20px;
                opacity: 0;
                transition: opacity 0.5s ease;
                /* Hardware acceleration */
                transform: translateZ(0);
                -webkit-transform: translateZ(0);
                will-change: opacity;
            }

            .page.active {
                display: flex;
                flex-direction: column;
                align-items: center;
                justify-content: center;
                opacity: 1;
            }

            /* Page 1 Styles - iOS Optimized */
            .welcome-container {
                background: rgba(255, 255, 255, 0.95);
                padding: 50px 30px;
                border-radius: 25px;
                box-shadow: 0 20px 60px rgba(0, 0, 0, 0.25);
                text-align: center;
                max-width: 500px;
                width: 90%;
                /* Hardware acceleration */
                transform: translateZ(0);
                -webkit-transform: translateZ(0);
                backface-visibility: hidden;
                -webkit-backface-visibility: hidden;
            }

            .welcome-title {
                font-family: 'Pacifico', cursive;
                font-size: 36px;
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                -webkit-background-clip: text;
                -webkit-text-fill-color: transparent;
                background-clip: text;
                margin-bottom: 20px;
                /* Reduce repaints */
                will-change: auto;
            }

            .hearts-decoration {
                font-size: 32px;
                margin: 20px 0;
            }

            .welcome-subtitle {
                font-size: 18px;
                color: #666;
                margin-bottom: 30px;
                line-height: 1.6;
            }

            .arrow-button {
                display: inline-block;
                margin-top: 20px;
                padding: 16px 40px;
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                color: white;
                border: none;
                border-radius: 50px;
                font-size: 18px;
                font-weight: 600;
                cursor: pointer;
                box-shadow: 0 10px 30px rgba(118, 75, 162, 0.4);
                touch-action: manipulation;
                /* Hardware acceleration */
                transform: translateZ(0);
                -webkit-transform: translateZ(0);
                backface-visibility: hidden;
                -webkit-backface-visibility: hidden;
                transition: transform 0.1s ease, box-shadow 0.1s ease;
            }

            .arrow-button:active {
                transform: translateZ(0) scale(0.95);
                -webkit-transform: translateZ(0) scale(0.95);
                box-shadow: 0 5px 20px rgba(118, 75, 162, 0.3);
            }

            /* Letter Styles - iOS Optimized */
            .letter-overlay {
                display: none;
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.85);
                z-index: 1000;
                align-items: center;
                justify-content: center;
                opacity: 0;
                transition: opacity 0.3s ease;
                /* Hardware acceleration */
                transform: translateZ(0);
                -webkit-transform: translateZ(0);
                backface-visibility: hidden;
                -webkit-backface-visibility: hidden;
            }

            .letter-overlay.show {
                display: flex;
                opacity: 1;
            }

            .envelope {
                width: 280px;
                height: 187px;
                position: relative;
                cursor: pointer;
                /* Hardware acceleration */
                transform: translateZ(0);
                -webkit-transform: translateZ(0);
            }

            .envelope-body {
                position: absolute;
                left: 0;
                width: 280px;
                height: 140px;
                background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
                border: 3px solid #e89f8a;
                border-top: none;
                border-radius: 0 0 10px 10px;
                /* Hardware acceleration */
                transform: translateZ(0);
                -webkit-transform: translateZ(0);
            }

            .envelope-body::before {
                content: 'üíå';
                position: absolute;
                top: 35px;
                left: 50%;
                transform: translateX(-50%) translateZ(0);
                -webkit-transform: translateX(-50%) translateZ(0);
                font-size: 48px;
            }

            .envelope-flap {
                width: 0;
                height: 0;
                border-left: 140px solid transparent;
                border-right: 140px solid transparent;
                border-top: 93px solid #fff5ee;
                position: absolute;
                top: 0;
                left: 0;
                transition: transform 0.8s ease;
                transform-origin: top;
                z-index: 20;
                will-change: transform;
            }

            .envelope.open .envelope-flap {
                transform: rotateX(180deg) translateZ(0);
                -webkit-transform: rotateX(180deg) translateZ(0);
                border-top-color: #ffecd2;
            }

            .letter-content {
                display: none;
                background: #ffffff;
                padding: 40px 30px;
                border-radius: 20px;
                max-width: 90%;
                width: 600px;
                max-height: 85vh;
                overflow-y: auto;
                box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
                /* iOS scroll optimization */
                -webkit-overflow-scrolling: touch;
                overscroll-behavior: contain;
                /* Hardware acceleration */
                transform: translateZ(0);
                -webkit-transform: translateZ(0);
                backface-visibility: hidden;
                -webkit-backface-visibility: hidden;
            }

            .letter-content.show {
                display: block;
                animation: slideUp 0.5s ease-out;
            }

            @keyframes slideUp {
                from {
                    opacity: 0;
                    transform: translateY(30px) translateZ(0);
                }
                to {
                    opacity: 1;
                    transform: translateY(0) translateZ(0);
                }
            }

            .letter-content h2 {
                font-family: 'Pacifico', cursive;
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                -webkit-background-clip: text;
                -webkit-text-fill-color: transparent;
                background-clip: text;
                margin-bottom: 25px;
                font-size: 26px;
            }

            .letter-content p {
                line-height: 1.8;
                color: #444;
                margin-bottom: 18px;
                text-align: justify;
                font-size: 16px;
            }

            .letter-content .signature {
                text-align: right;
                font-weight: 600;
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                -webkit-background-clip: text;
                -webkit-text-fill-color: transparent;
                background-clip: text;
                margin-top: 30px;
                font-style: italic;
                font-size: 18px;
            }

            /* Page 2 - Gallery */
            .gallery-container {
                width: 90%;
                max-width: 800px;
                padding: 40px 20px;
                background: rgba(255, 255, 255, 0.95);
                border-radius: 25px;
                box-shadow: 0 20px 60px rgba(0, 0, 0, 0.25);
                /* Hardware acceleration */
                transform: translateZ(0);
                -webkit-transform: translateZ(0);
                backface-visibility: hidden;
                -webkit-backface-visibility: hidden;
            }

            .gallery-title {
                text-align: center;
                font-family: 'Pacifico', cursive;
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                -webkit-background-clip: text;
                -webkit-text-fill-color: transparent;
                background-clip: text;
                font-size: 42px;
                margin-bottom: 30px;
            }

            .gallery-description {
                text-align: center;
                color: #666;
                font-size: 18px;
                margin-bottom: 30px;
                line-height: 1.6;
            }

            .qr-wrapper {
                background: white;
                padding: 30px;
                border-radius: 20px;
                box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
                margin: 30px auto;
                max-width: 350px;
                text-align: center;
            }

            .qr-code {
                width: 100%;
                max-width: 280px;
                height: auto;
                aspect-ratio: 1;
                margin: 0 auto;
                background: #f8f8f8;
                border: 4px solid #764ba2;
                border-radius: 15px;
                display: flex;
                align-items: center;
                justify-content: center;
                overflow: hidden;
            }

            .qr-code img {
                width: 100%;
                height: 100%;
                object-fit: cover;
            }

            .qr-label {
                margin-top: 20px;
                font-size: 20px;
                font-weight: 600;
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                -webkit-background-clip: text;
                -webkit-text-fill-color: transparent;
                background-clip: text;
            }

            /* Optimized hearts animation - paused during scroll */
            .hearts-animation {
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                pointer-events: none;
                z-index: 1;
                display: none;
                /* Hardware acceleration */
                transform: translateZ(0);
                -webkit-transform: translateZ(0);
            }

            .hearts-animation.active {
                display: block;
            }

            .hearts-animation.paused .heart {
                animation-play-state: paused;
            }

            .heart {
                position: absolute;
                font-size: 24px;
                opacity: 0;
                animation: float-heart 5s ease-in forwards;
                /* Hardware acceleration */
                will-change: transform, opacity;
                backface-visibility: hidden;
                -webkit-backface-visibility: hidden;
            }

            @keyframes float-heart {
                0% {
                    transform: translateY(100vh) translateZ(0) scale(1);
                    opacity: 0.7;
                }
                50% {
                    opacity: 0.9;
                }
                100% {
                    transform: translateY(-100px) translateZ(0) scale(0.6);
                    opacity: 0;
                }
            }

            .music-control {
                position: fixed;
                bottom: 25px;
                right: 25px;
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                border-radius: 50%;
                width: 65px;
                height: 65px;
                display: flex;
                align-items: center;
                justify-content: center;
                cursor: pointer;
                box-shadow: 0 8px 25px rgba(118, 75, 162, 0.4);
                z-index: 1001;
                touch-action: manipulation;
                font-size: 30px;
                /* Hardware acceleration */
                transform: translateZ(0);
                -webkit-transform: translateZ(0);
                backface-visibility: hidden;
                -webkit-backface-visibility: hidden;
                transition: transform 0.1s ease;
            }

            .music-control:active {
                transform: translateZ(0) scale(0.95);
                -webkit-transform: translateZ(0) scale(0.95);
            }

            @media (max-width: 768px) {
                .welcome-container {
                    padding: 40px 25px;
                }

                .welcome-title {
                    font-size: 30px;
                }

                .letter-content {
                    padding: 30px 20px;
                }

                .letter-content h2 {
                    font-size: 22px;
                }

                .letter-content p {
                    font-size: 15px;
                }

                .gallery-container {
                    padding: 30px 15px;
                }

                .gallery-title {
                    font-size: 34px;
                }

                .envelope {
                    width: 240px;
                    height: 160px;
                }

                .envelope-body {
                    width: 240px;
                    height: 120px;
                }

                .envelope-flap {
                    border-left: 120px solid transparent;
                    border-right: 120px solid transparent;
                    border-top: 80px solid #fff5ee;
                }

                .music-control {
                    width: 55px;
                    height: 55px;
                    font-size: 26px;
                    bottom: 20px;
                    right: 20px;
                }
            }
        </style>
    </head>
    <body>
        <!-- Hearts Animation -->
        <div class="hearts-animation" id="heartsContainer"></div>

        <!-- Music Control -->
        <div class="music-control" id="musicControl" title="Ph√°t/T·∫Øt nh·∫°c">üéµ</div>

        <!-- Page 1 - Welcome -->
        <div class="page active" id="page1">
            <div class="welcome-container">
                <div class="welcome-title">Happy 5 Months</div>
                <div class="hearts-decoration">üíï üíñ üíï</div>
                <div class="welcome-subtitle">
                    Ch√†o anh b√© y√™u c·ªßa em!<br />
                    Em c√≥ ƒëi·ªÅu mu·ªën n√≥i v·ªõi anh...
                </div>
                <button class="arrow-button" onclick="showLetter()">‚ú® M·ªü Th∆∞ T√¨nh ‚ú®</button>
            </div>
        </div>

        <!-- Letter Overlay -->
        <div class="letter-overlay" id="letterOverlay">
            <div class="envelope" id="envelope" onclick="openLetter()">
                <div class="envelope-flap"></div>
                <div class="envelope-body"></div>
            </div>
            <div class="letter-content" id="letterContent">
                <h2>Xin ch√†o anh b√© y√™u c·ªßa em,</h2>
                <p>
                    H√¥m nay tr√≤n 5 th√°ng ch√∫ng m√¨nh b√™n nhau---m·ªôt kho·∫£ng th·ªùi gian kh√¥ng d√†i, nh∆∞ng ƒë·ªß ƒë·ªÉ tr√°i tim em
                    quen v·ªõi s·ª± hi·ªán di·ªán c·ªßa anh, d√π ch·ªâ qua nh·ªØng tin nh·∫Øn, nh·ªØng cu·ªôc g·ªçi v√† nh·ªØng y√™u th∆∞∆°ng t·ª´ xa.
                    Y√™u xa ƒë√¥i khi l√† nh·ªØng ƒë√™m d√†i h∆°n m·ªôt ch√∫t, nh·ªØng nhung nh·ªõ nhi·ªÅu h∆°n m·ªôt ch√∫t... nh∆∞ng c≈©ng ch√≠nh
                    v√¨ th·∫ø m√† m·ªói kho·∫£nh kh·∫Øc ch√∫ng m√¨nh c√≥ c√πng nhau ƒë·ªÅu tr·ªü n√™n qu√Ω gi√° v√† ch√¢n th√†nh h∆°n r·∫•t nhi·ªÅu.
                </p>

                <p>
                    Noel nƒÉm nay l√† Noel ƒë·∫ßu ti√™n c·ªßa ch√∫ng m√¨nh. D√π kh√¥ng ƒë∆∞·ª£c n·∫Øm tay anh ƒëi gi·ªØa ph·ªë ƒë√®n hoa hay t·ª±a
                    v√†o vai anh nghe nh·ªØng b·∫£n nh·∫°c Gi√°ng sinh, nh∆∞ng tim em v·∫´n ƒë·∫ßy √°nh s√°ng---v√¨ em bi·∫øt ·ªü m·ªôt n∆°i
                    kh√°c, anh c≈©ng ƒëang nghƒ© v·ªÅ em.
                </p>

                <p>
                    C·∫£m ∆°n anh v√¨ ng√†y h√¥m ·∫•y ƒë√£ xu·∫•t hi·ªán trong cu·ªôc ƒë·ªùi em, ƒë·ªÉ em bi·∫øt r·∫±ng h·∫°nh ph√∫c v·∫´n ·ªü ƒë√≥ ch·ªù
                    m√¨nh t√¨m th·∫•y, v√† em v·∫´n x·ª©ng ƒë√°ng ƒë∆∞·ª£c y√™u th∆∞∆°ng. C·∫£m ∆°n anh v√¨ ƒë√£ ƒë·∫øn v√† th∆∞∆°ng em m·ªôt c√°ch tr·ªçn
                    v·∫πn, ch√¢n th√†nh. Anh l√† ng∆∞·ªùi √¢m th·∫ßm xoa d·ªãu nh·ªØng t·ªïn th∆∞∆°ng em t·ª´ng mang, kh√¥ng b·∫≠n t√¢m qu√° kh·ª©
                    em t·ªá ƒë·∫øn nh∆∞·ªùng n√†o; ng∆∞·ª£c l·∫°i, anh mang ƒë·∫øn cho em nh·ªØng ni·ªÅm vui, nh·ªØng n·ª• c∆∞·ªùi m√† l√¢u l·∫Øm r·ªìi em
                    m·ªõi ƒë∆∞·ª£c c·∫£m nh·∫≠n. Anh cho em s·ª± an to√†n v√† b√¨nh y√™n---ƒëi·ªÅu m√† em c·∫ßn nh·∫•t.
                </p>

                <p>
                    C·∫£m ∆°n anh v√¨ ƒë√£ lu√¥n ki√™n nh·∫´n, ·∫•m √°p, v√† che ch·ªü cho em. C·∫£m ∆°n anh ƒë√£ bao dung nh·ªØng th√≥i x·∫•u c·ªßa
                    em, lu√¥n kh√¥ng ƒë·ªÉ em bu·ªìn m·ªôt m√¨nh, chuy·ªán g√¨ c≈©ng c√πng em t√¨m c√°ch gi·∫£i quy·∫øt... m·∫∑c d√π c√≥ nh·ªØng
                    l√∫c nh√¨n anh ƒë√°ng gh√©t kh√¥ng ch·ªãu n·ªïi. C·∫£m ∆°n anh v√¨ ƒë√£ ƒë·∫øn qu·∫≠y ƒë·ª•c cu·ªôc s·ªëng bu·ªìn t·∫ª c·ªßa em, v√†
                    h∆°n h·∫øt---c·∫£m ∆°n v√¨ ƒë·∫øn gi·ªù v·∫´n n·∫Øm ch·∫∑t tay em kh√¥ng bu√¥ng.
                </p>

                <p>
                    Em tin m·ªôt ng√†y kh√¥ng xa, Noel s·∫Ω kh√¥ng c√≤n l√† c√¢u chuy·ªán qua m√†n h√¨nh n·ªØa, m√† s·∫Ω l√† nh·ªØng c√°i √¥m
                    g·∫ßn, l√† s·ª± b√¨nh y√™n khi c√≥ anh b√™n c·∫°nh.
                </p>

                <p>
                    Ch√∫c anh m·ªôt m√πa Gi√°ng sinh an l√†nh, ·∫•m √°p. Ch√∫c cho ch√∫ng m√¨nh ti·∫øp t·ª•c m·∫°nh m·∫Ω, y√™u th∆∞∆°ng v√† tin
                    t∆∞·ªüng.
                </p>

                <div class="signature">
                    Happy 5 months, my love.<br />
                    Em th∆∞∆°ng anh r·∫•t nhi·ªÅu. ‚ù§Ô∏è
                </div>

                <button class="arrow-button" onclick="goToGallery()" style="margin-top: 30px">
                    üí´ Xem K·ª∑ Ni·ªám C·ªßa Ch√∫ng M√¨nh üí´
                </button>
            </div>
        </div>

        <!-- Page 2 - Gallery -->
        <div class="page" id="page2">
            <div class="gallery-container">
                <div class="gallery-title">‚ú® Galaxy Love ‚ú®</div>
                <div class="gallery-description">
                    Nh·ªØng kho·∫£nh kh·∫Øc y√™u th∆∞∆°ng c·ªßa ch√∫ng m√¨nh<br />
                    Qu√©t m√£ QR ƒë·ªÉ xem th√™m nhi·ªÅu k·ª∑ ni·ªám ƒë·∫πp nh√©! üíï
                </div>

                <div class="qr-wrapper">
                    <div class="qr-code">
                        <img src="images/main-page/qr-2.png" alt="Galaxy Love QR" loading="lazy" />
                    </div>
                    <div class="qr-label">Scan me!</div>
                </div>
            </div>
        </div>

        <!-- Audio -->
        <audio id="bgMusic" loop preload="none">
            <source src="audios/Nguy·ªán Y√™u.mp3" type="audio/mpeg" />
        </audio>

        <script>
            // Music control - iOS optimized
            const music = document.getElementById('bgMusic')
            const musicControl = document.getElementById('musicControl')
            let isPlaying = false
            let audioContext = null

            // iOS requires user interaction to play audio
            function initAudio() {
                if (!audioContext) {
                    audioContext = new (window.AudioContext || window.webkitAudioContext)()
                }
                if (audioContext.state === 'suspended') {
                    audioContext.resume()
                }
            }

            musicControl.addEventListener('click', (e) => {
                e.preventDefault()
                initAudio()
                
                if (isPlaying) {
                    music.pause()
                    musicControl.textContent = 'üéµ'
                } else {
                    music.play().catch(() => {})
                    musicControl.textContent = 'üé∂'
                }
                isPlaying = !isPlaying
            })

            // Try auto play on first interaction
            let firstInteraction = true
            document.addEventListener('click', function playMusic() {
                if (firstInteraction && !isPlaying) {
                    firstInteraction = false
                    initAudio()
                    music.play().then(() => {
                        musicControl.textContent = 'üé∂'
                        isPlaying = true
                    }).catch(() => {})
                }
            }, { once: true })

            // Optimized hearts animation
            let heartCount = 0
            const maxHearts = 4 // Reduced for better performance
            let heartInterval
            let isScrolling = false
            let scrollTimeout
            const heartsContainer = document.getElementById('heartsContainer')

            function createHeart() {
                if (heartCount >= maxHearts || isScrolling) return

                const heart = document.createElement('div')
                heart.className = 'heart'
                const hearts = ['üíï', 'üíñ', 'üíó']
                heart.textContent = hearts[Math.floor(Math.random() * hearts.length)]
                heart.style.left = Math.random() * 100 + '%'
                heart.style.animationDelay = Math.random() * 2 + 's'
                heartsContainer.appendChild(heart)

                heartCount++

                setTimeout(() => {
                    heart.remove()
                    heartCount--
                }, 5000)
            }

            // Start hearts animation
            function startHearts() {
                heartsContainer.classList.add('active')
                heartInterval = setInterval(createHeart, 2500) // Slower creation
            }

            // Stop hearts animation
            function stopHearts() {
                clearInterval(heartInterval)
                heartsContainer.classList.remove('active')
            }

            // Pause hearts during scroll - iOS optimization
            function pauseHearts() {
                heartsContainer.classList.add('paused')
                isScrolling = true
            }

            function resumeHearts() {
                heartsContainer.classList.remove('paused')
                isScrolling = false
            }

            // Detect scrolling and pause hearts
            let scrollElements = [window, document.getElementById('letterContent')]
            scrollElements.forEach(element => {
                if (element) {
                    element.addEventListener('scroll', () => {
                        pauseHearts()
                        clearTimeout(scrollTimeout)
                        scrollTimeout = setTimeout(resumeHearts, 200)
                    }, { passive: true })
                }
            })

            // Start hearts on page load - delayed for better initial performance
            setTimeout(startHearts, 1500)

            // Show letter
            function showLetter() {
                document.getElementById('letterOverlay').classList.add('show')
                initAudio()

                if (!isPlaying) {
                    music.play().then(() => {
                        musicControl.textContent = 'üé∂'
                        isPlaying = true
                    }).catch(() => {})
                }
            }

            // Open letter - iOS optimized
            function openLetter() {
                const envelope = document.getElementById('envelope')
                const letterContent = document.getElementById('letterContent')

                envelope.classList.add('open')
                setTimeout(() => {
                    envelope.style.display = 'none'
                    letterContent.classList.add('show')

                    // Force iOS Safari to render properly
                    requestAnimationFrame(() => {
                        letterContent.scrollTop = 0
                        letterContent.style.WebkitOverflowScrolling = 'touch'
                    })
                }, 800)
            }

            // Go to gallery
            function goToGallery() {
                document.getElementById('page1').classList.remove('active')
                document.getElementById('letterOverlay').classList.remove('show')
                
                // Small delay for smooth transition
                setTimeout(() => {
                    document.getElementById('page2').classList.add('active')
                }, 100)
            }

            // Pause animations when page is hidden
            document.addEventListener('visibilitychange', () => {
                if (document.hidden) {
                    if (isPlaying) music.pause()
                    pauseHearts()
                } else {
                    if (isPlaying) music.play().catch(() => {})
                    resumeHearts()
                }
            })

            // iOS performance optimization - reduce animations on low memory
            if (window.performance && window.performance.memory) {
                if (window.performance.memory.jsHeapSizeLimit < 1000000000) {
                    maxHearts = 2
                }
            }
        </script>
    </body>
</html>