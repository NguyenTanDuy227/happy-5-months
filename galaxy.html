<!DOCTYPE html>
<html lang="vi">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <link type="image/png" sizes="16x16" rel="icon" href="favicons/icons8-favorite-windows-11-color-16.png" />
        <link type="image/png" sizes="32x32" rel="icon" href="favicons/icons8-favorite-windows-11-color-32.png" />
        <link type="image/png" sizes="96x96" rel="icon" href="favicons/icons8-favorite-windows-11-color-96.png" />
        <title>H√†nh Tinh L√£ng M·∫°n</title>
        <style>
            * {
                margin: 0;
                padding: 0;
                box-sizing: border-box;
            }

            body {
                overflow: hidden;
                background: #0a0015;
                font-family: 'Arial', sans-serif;
            }

            #canvas {
                display: block;
                width: 100%;
                height: 100vh;
            }

            .info {
                position: absolute;
                top: 30px;
                left: 50%;
                transform: translateX(-50%);
                color: #ff69b4;
                text-align: center;
                font-size: 32px;
                font-weight: bold;
                text-shadow: 0 0 20px rgba(255, 105, 180, 0.8), 0 0 40px rgba(255, 105, 180, 0.5);
                z-index: 10;
                pointer-events: none;
                animation: glow 2s ease-in-out infinite;
            }

            @keyframes glow {
                0%,
                100% {
                    text-shadow: 0 0 20px rgba(255, 105, 180, 0.8), 0 0 40px rgba(255, 105, 180, 0.5);
                }
                50% {
                    text-shadow: 0 0 30px rgba(255, 105, 180, 1), 0 0 60px rgba(255, 105, 180, 0.8);
                }
            }

            .subtitle {
                font-size: 16px;
                font-weight: normal;
                margin-top: 10px;
                color: #ffb3d9;
            }

            .rotate-notice {
                display: none;
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(10, 0, 21, 0.95);
                z-index: 9999;
                justify-content: center;
                align-items: center;
                flex-direction: column;
            }

            .rotate-icon {
                font-size: 80px;
                margin-bottom: 20px;
                animation: rotate-animation 2s ease-in-out infinite;
            }

            @keyframes rotate-animation {
                0%,
                100% {
                    transform: rotate(0deg);
                }
                50% {
                    transform: rotate(90deg);
                }
            }

            .rotate-text {
                color: #ff69b4;
                font-size: 20px;
                text-align: center;
                padding: 0 20px;
                text-shadow: 0 0 10px rgba(255, 105, 180, 0.5);
            }

            @media (max-width: 768px) and (orientation: portrait) {
                .rotate-notice {
                    display: flex;
                }
            }

            .music-controls {
                position: absolute;
                bottom: 30px; /* ƒê·∫∑t ·ªü d∆∞·ªõi c√πng */
                left: 50%;
                transform: translateX(-50%);
                z-index: 10;
                text-align: center;
            }

            #music-toggle-btn {
                background: rgba(255, 105, 180, 0.7);
                color: #0a0015;
                border: 2px solid #ffb3d9;
                padding: 10px 20px;
                font-size: 16px;
                font-weight: bold;
                border-radius: 25px;
                cursor: pointer;
                outline: none;
                transition: all 0.3s ease;
                box-shadow: 0 0 15px rgba(255, 105, 180, 0.5);
            }

            #music-toggle-btn:hover {
                background: #ff69b4;
                box-shadow: 0 0 20px #ff69b4;
                transform: scale(1.05);
            }
        </style>
    </head>
    <body>
        <div class="rotate-notice">
            <div class="rotate-icon">üì±‚ûúüì±</div>
            <div class="rotate-text">
                Vui l√≤ng xoay ngang m√†n h√¨nh<br />
                ƒë·ªÉ c√≥ tr·∫£i nghi·ªám t·ªët nh·∫•t ‚ú®
            </div>
        </div>

        <div class="info">
            ‚ú® Milky Way Galaxy ‚ú®
            <div class="subtitle">V≈© tr·ª• c·ªßa t√¨nh y√™u ch√∫ng ta</div>
        </div>

        <div class="music-controls">
            <audio id="background-music" loop>
                <source src="audios/Nguy·ªán Y√™u.mp3" type="audio/mp3" />
                Tr√¨nh duy·ªát c·ªßa b·∫°n kh√¥ng h·ªó tr·ª£ ph·∫ßn t·ª≠ audio.
            </audio>
            <button id="music-toggle-btn">üéµ T·∫Øt Nh·∫°c</button>
        </div>

        <canvas id="canvas"></canvas>

        <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
        <script src="https://unpkg.com/three@0.128.0/examples/js/controls/OrbitControls.js"></script>
        <script>
            // ===== TH√äM ƒê∆Ø·ªúNG D·∫™N ·∫¢NH C·ª¶A B·∫†N ·ªû ƒê√ÇY =====
            const imageUrls = [
                'images/galaxy/Picture2.jpg', // ·∫¢nh 1
                'images/galaxy/Picture3.jpg', // ·∫¢nh 2
                'images/galaxy/Picture4.jpg', // ·∫¢nh 3
                'images/galaxy/Picture5.jpg', // ·∫¢nh 4
                'images/galaxy/Picture6.jpg', // ·∫¢nh 5
                'images/galaxy/Picture7.jpg', // ·∫¢nh 6
                'images/galaxy/Picture8.jpg', // ·∫¢nh 7
                'images/galaxy/Picture9.jpg', // ·∫¢nh 8
                'images/galaxy/Picture10.jpg', // ·∫¢nh 9
                'images/galaxy/Picture11.jpg', // ·∫¢nh 10
                'images/galaxy/Picture12.jpg', // ·∫¢nh 11
                'images/galaxy/Picture13.jpg', // ·∫¢nh 12
                'images/galaxy/Picture14.jpg', // ·∫¢nh 13
                'images/galaxy/Picture15.jpg' // ·∫¢nh 14
            ]
            // ===========================================

            const canvas = document.getElementById('canvas')
            const scene = new THREE.Scene()

            const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000)
            camera.position.z = 14

            const renderer = new THREE.WebGLRenderer({ canvas, antialias: true, alpha: true })
            renderer.setSize(window.innerWidth, window.innerHeight)
            renderer.setClearColor(0x0a0015, 1)

            // ‚ú® KH·ªûI T·∫†O ORBITCONTROLS (cho ph√©p qu·∫πt/vu·ªët ƒë·ªÉ quay) ‚ú®
            const controls = new THREE.OrbitControls(camera, renderer.domElement)
            controls.enableDamping = true // Cho chuy·ªÉn ƒë·ªông m∆∞·ª£t m√†
            controls.dampingFactor = 0.05
            controls.screenSpacePanning = false
            controls.minDistance = 5 // Zoom t·ªëi thi·ªÉu
            controls.maxDistance = 30 // Zoom t·ªëi ƒëa
            controls.autoRotate = false // T·∫Øt t·ª± ƒë·ªông quay
            controls.target.set(0, 0, 0) // ƒê·∫∑t m·ª•c ti√™u xoay l√† trung t√¢m (h√†nh tinh)
            controls.update()
            // ‚ú® K·∫æT TH√öC KH·ªûI T·∫†O ORBITCONTROLS ‚ú®

            // √Ånh s√°ng
            const ambientLight = new THREE.AmbientLight(0xffffff, 0.5)
            scene.add(ambientLight)

            const pointLight1 = new THREE.PointLight(0xff69b4, 2, 100)
            pointLight1.position.set(10, 10, 10)
            scene.add(pointLight1)

            const pointLight2 = new THREE.PointLight(0xffb3d9, 1.5, 100)
            pointLight2.position.set(-10, -10, -10)
            scene.add(pointLight2)

            const pointLight3 = new THREE.PointLight(0xff1493, 1.8, 100)
            pointLight3.position.set(0, 15, 5)
            scene.add(pointLight3)

            // H√†nh tinh trung t√¢m
            const planetGeometry = new THREE.SphereGeometry(3.5, 64, 64)
            const planetMaterial = new THREE.MeshPhongMaterial({
                color: 0xffb3d9,
                emissive: 0xff69b4,
                emissiveIntensity: 0.5,
                shininess: 150,
                specular: 0xffffff
            })
            const planet = new THREE.Mesh(planetGeometry, planetMaterial)
            scene.add(planet)

            // V√≤ng s√°ng xung quanh h√†nh tinh
            const glowGeometry = new THREE.SphereGeometry(3.9, 32, 32)
            const glowMaterial = new THREE.MeshBasicMaterial({
                color: 0xff69b4,
                transparent: true,
                opacity: 0.2,
                side: THREE.BackSide
            })
            const glow = new THREE.Mesh(glowGeometry, glowMaterial)
            scene.add(glow)

            // C√°c v√≤ng quang
            const rings = []
            for (let i = 0; i < 3; i++) {
                const ringGeometry = new THREE.TorusGeometry(4.5 + i * 0.7, 0.1, 16, 100)
                const ringMaterial = new THREE.MeshPhongMaterial({
                    color: new THREE.Color().setHSL(0.9 + i * 0.02, 0.8, 0.6),
                    emissive: new THREE.Color().setHSL(0.9 + i * 0.02, 1, 0.5),
                    emissiveIntensity: 0.6,
                    transparent: true,
                    opacity: 0.7 - i * 0.1
                })
                const ring = new THREE.Mesh(ringGeometry, ringMaterial)
                ring.rotation.x = Math.PI / 2.5 + i * 0.1
                ring.userData.rotationSpeed = 0.003 + i * 0.001
                scene.add(ring)
                rings.push(ring)
            }

            // T·∫°o 14 khung h√¨nh
            const photoFrames = []
            const textureLoader = new THREE.TextureLoader()

            function createPhotoFrame(index, imageUrl) {
                const frameGroup = new THREE.Group()

                // M·∫∑t ph·∫≥ng cho ·∫£nh
                const photoGeometry = new THREE.PlaneGeometry(3, 3)
                const photoMaterial = new THREE.MeshBasicMaterial({
                    color: 0xffffff,
                    side: THREE.DoubleSide
                })

                // Load ·∫£nh n·∫øu c√≥ URL
                if (imageUrl && imageUrl.trim() !== '') {
                    textureLoader.load(imageUrl, function (texture) {
                        photoMaterial.map = texture
                        photoMaterial.needsUpdate = true
                    })
                }

                const photo = new THREE.Mesh(photoGeometry, photoMaterial)
                frameGroup.add(photo)

                // Vi·ªÅn khung s√°ng
                const borderGeometry = new THREE.PlaneGeometry(3.4, 3.4)
                const borderMaterial = new THREE.MeshPhongMaterial({
                    color: 0xff69b4,
                    emissive: 0xff1493,
                    emissiveIntensity: 0.6,
                    transparent: true,
                    opacity: 0.8
                })
                const border = new THREE.Mesh(borderGeometry, borderMaterial)
                border.position.z = -0.05
                frameGroup.add(border)

                // H√†o quang
                const haloGeometry = new THREE.PlaneGeometry(4, 4)
                const haloMaterial = new THREE.MeshBasicMaterial({
                    color: 0xff69b4,
                    transparent: true,
                    opacity: 0.2,
                    side: THREE.DoubleSide
                })
                const halo = new THREE.Mesh(haloGeometry, haloMaterial)
                halo.position.z = -0.1
                frameGroup.add(halo)

                // V·ªã tr√≠ qu·ªπ ƒë·∫°o
                const angle = (index / 14) * Math.PI * 2
                const radius = 10 + (index % 3) * 2 // TƒÉng b√°n k√≠nh qu·ªπ ƒë·∫°o

                frameGroup.userData = {
                    angle: angle,
                    radius: radius,
                    speed: 0.15 + (index % 4) * 0.05,
                    photo: photo,
                    border: border,
                    halo: halo,
                    index: index
                }

                scene.add(frameGroup)
                photoFrames.push(frameGroup)

                return frameGroup
            }

            // T·∫°o t·∫•t c·∫£ 14 khung h√¨nh
            for (let i = 0; i < 14; i++) {
                createPhotoFrame(i, imageUrls[i])
            }

            // H·∫°t s√°ng
            const particlesGeometry = new THREE.BufferGeometry()
            const particleCount = 3000
            const positions = new Float32Array(particleCount * 3)
            const colors = new Float32Array(particleCount * 3)
            const sizes = new Float32Array(particleCount)

            for (let i = 0; i < particleCount; i++) {
                positions[i * 3] = (Math.random() - 0.5) * 100
                positions[i * 3 + 1] = (Math.random() - 0.5) * 100
                positions[i * 3 + 2] = (Math.random() - 0.5) * 100

                const color = new THREE.Color()
                color.setHSL(0.85 + Math.random() * 0.15, 0.8, 0.6)
                colors[i * 3] = color.r
                colors[i * 3 + 1] = color.g
                colors[i * 3 + 2] = color.b

                sizes[i] = Math.random() * 3
            }

            particlesGeometry.setAttribute('position', new THREE.BufferAttribute(positions, 3))
            particlesGeometry.setAttribute('color', new THREE.BufferAttribute(colors, 3))
            particlesGeometry.setAttribute('size', new THREE.BufferAttribute(sizes, 1))

            const particlesMaterial = new THREE.PointsMaterial({
                size: 0.2,
                vertexColors: true,
                transparent: true,
                opacity: 0.8,
                blending: THREE.AdditiveBlending
            })

            const particles = new THREE.Points(particlesGeometry, particlesMaterial)
            scene.add(particles)

            // C√°c v·∫≠t th·ªÉ ph√°t s√°ng
            const orbitingObjects = []
            for (let i = 0; i < 20; i++) {
                const geometry = new THREE.OctahedronGeometry(0.3)
                const hue = 0.85 + Math.random() * 0.15
                const material = new THREE.MeshPhongMaterial({
                    color: new THREE.Color().setHSL(hue, 0.9, 0.6),
                    emissive: new THREE.Color().setHSL(hue, 1, 0.5),
                    emissiveIntensity: 0.8,
                    shininess: 150
                })

                const obj = new THREE.Mesh(geometry, material)

                const angle = (i / 20) * Math.PI * 2
                const radius = 6 + Math.random() * 3

                obj.userData = {
                    angle: angle,
                    radius: radius,
                    speed: 0.3 + Math.random() * 0.4,
                    rotationSpeed: 0.02 + Math.random() * 0.03
                }

                scene.add(obj)
                orbitingObjects.push(obj)
            }

            // Animation
            let time = 0
            function animate() {
                requestAnimationFrame(animate)
                time += 0.01

                // Xoay h√†nh tinh
                planet.rotation.y += 0.005
                glow.rotation.y -= 0.003
                glow.material.opacity = 0.2 + Math.sin(time * 2) * 0.1

                // Xoay c√°c v√≤ng quang
                rings.forEach(ring => {
                    ring.rotation.z += ring.userData.rotationSpeed
                })

                // Di chuy·ªÉn 14 khung h√¨nh
                photoFrames.forEach(frame => {
                    frame.userData.angle += frame.userData.speed * 0.008

                    const x = Math.cos(frame.userData.angle) * frame.userData.radius
                    const z = Math.sin(frame.userData.angle) * frame.userData.radius
                    const y = Math.sin(time * 1.5 + frame.userData.index * 0.5) * 2

                    frame.position.set(x, y, z)
                    frame.lookAt(planet.position)

                    // Hi·ªáu ·ª©ng nh·∫•p nh√°y
                    frame.userData.halo.material.opacity = 0.2 + Math.sin(time * 3 + frame.userData.index) * 0.15
                    frame.userData.border.material.emissiveIntensity =
                        0.6 + Math.sin(time * 4 + frame.userData.index) * 0.3
                })

                // Di chuy·ªÉn c√°c v·∫≠t th·ªÉ ph√°t s√°ng
                orbitingObjects.forEach(obj => {
                    obj.userData.angle += obj.userData.speed * 0.01

                    obj.position.x = Math.cos(obj.userData.angle) * obj.userData.radius
                    obj.position.z = Math.sin(obj.userData.angle) * obj.userData.radius
                    obj.position.y = Math.sin(time * 2 + obj.userData.angle) * 2

                    obj.rotation.x += obj.userData.rotationSpeed
                    obj.rotation.y += obj.userData.rotationSpeed
                })

                // Xoay h·∫°t s√°ng
                particles.rotation.y += 0.0003
                const positionsAttr = particles.geometry.attributes.position.array
                for (let i = 0; i < positionsAttr.length; i += 3) {
                    positionsAttr[i + 1] += Math.sin(time + i) * 0.01
                }
                particles.geometry.attributes.position.needsUpdate = true

                // Di chuy·ªÉn √°nh s√°ng
                pointLight1.position.x = Math.cos(time * 0.5) * 15
                pointLight1.position.z = Math.sin(time * 0.5) * 15

                pointLight2.position.x = Math.cos(time * 0.7 + Math.PI) * 12
                pointLight2.position.z = Math.sin(time * 0.7 + Math.PI) * 12

                pointLight3.position.x = Math.sin(time * 0.3) * 10
                pointLight3.position.z = Math.cos(time * 0.3) * 10

                // ‚ú® C·∫¨P NH·∫¨T ORBITCONTROLS ‚ú®
                controls.update()

                renderer.render(scene, camera)
            }

            // X·ª≠ l√Ω resize
            window.addEventListener('resize', () => {
                camera.aspect = window.innerWidth / window.innerHeight
                camera.updateProjectionMatrix()
                renderer.setSize(window.innerWidth, window.innerHeight)
                // C·∫≠p nh·∫≠t controls sau khi resize
                controls.update()
            })

            // ‚ú® X√≥a t∆∞∆°ng t√°c chu·ªôt c≈©, thay b·∫±ng OrbitControls ‚ú®

            animate()

            const audio = document.getElementById('background-music')
            const toggleBtn = document.getElementById('music-toggle-btn')
            let isPlaying = true // Ban ƒë·∫ßu gi·∫£ ƒë·ªãnh ƒëang ph√°t (v√¨ c√≥ autoplay)

            // H√†m ph√°t nh·∫°c
            function playAudio() {
                // D√πng .play() ƒë·ªÉ v∆∞·ª£t qua ch√≠nh s√°ch autoplay sau khi ng∆∞·ªùi d√πng ƒë√£ t∆∞∆°ng t√°c.
                audio
                    .play()
                    .then(() => {
                        isPlaying = true
                        toggleBtn.textContent = 'üéµ T·∫Øt Nh·∫°c'
                    })
                    .catch(error => {
                        // X·ª≠ l√Ω l·ªói n·∫øu vi·ªác ph√°t kh√¥ng th√†nh c√¥ng (v√≠ d·ª•: tr√¨nh duy·ªát ch·∫∑n)
                        console.error('L·ªói khi ph√°t nh·∫°c:', error)
                        isPlaying = false
                        toggleBtn.textContent = 'üé∂ B·∫≠t Nh·∫°c'
                    })
            }

            // H√†m t·∫°m d·ª´ng nh·∫°c
            function pauseAudio() {
                audio.pause()
                isPlaying = false
                toggleBtn.textContent = 'üé∂ B·∫≠t Nh·∫°c'
            }

            // X·ª≠ l√Ω s·ª± ki·ªán khi ng∆∞·ªùi d√πng nh·∫•n n√∫t
            toggleBtn.addEventListener('click', () => {
                if (isPlaying) {
                    pauseAudio()
                } else {
                    // G·ªçi h√†m playAudio ƒë·ªÉ k√≠ch ho·∫°t nh·∫°c
                    playAudio()
                }
            })

            // TH√äM: C·ªë g·∫Øng ph√°t l·∫ßn ƒë·∫ßu ti√™n m√† kh√¥ng c√≥ t∆∞∆°ng t√°c ng∆∞·ªùi d√πng
            // ƒêi·ªÅu n√†y TH∆Ø·ªúNG s·∫Ω b·ªã ch·∫∑n, nh∆∞ng n·∫øu n√≥ th√†nh c√¥ng (m·ªôt s·ªë tr√¨nh duy·ªát/ƒëi·ªÅu ki·ªán cho ph√©p),
            // th√¨ √¢m thanh s·∫Ω ph√°t. Quan tr·ªçng l√† ng∆∞·ªùi d√πng v·∫´n c√≥ n√∫t ƒë·ªÉ ƒëi·ªÅu khi·ªÉn.
            // N·∫øu tr√¨nh duy·ªát ch·∫∑n, n√∫t s·∫Ω t·ª± ƒë·ªông chuy·ªÉn th√†nh 'üé∂ B·∫≠t Nh·∫°c' sau l·∫ßn ƒë·∫ßu nh·∫•n.

            // CH·ªà C·∫¶N B·ªî SUNG ƒêO·∫†N JS N√ÄY ·ªû CU·ªêI TH·∫∫ <script> C·ª¶A B·∫†N:

            document.addEventListener('DOMContentLoaded', () => {
                // Th·ª≠ ph√°t ngay. N·∫øu th√†nh c√¥ng (nh·ªù ch√≠nh s√°ch n·ªõi l·ªèng ho·∫∑c t∆∞∆°ng t√°c tr∆∞·ªõc ƒë√≥), n√≥ s·∫Ω ph√°t.
                // N·∫øu th·∫•t b·∫°i (th∆∞·ªùng x·∫£y ra), nh·∫°c s·∫Ω kh√¥ng ph√°t, v√† n√∫t v·∫´n l√† 'üéµ T·∫Øt Nh·∫°c'.
                // L·∫ßn nh·∫•n n√∫t ƒë·∫ßu ti√™n c·ªßa ng∆∞·ªùi d√πng s·∫Ω k√≠ch ho·∫°t playAudio().
                audio.play().catch(error => {
                    // N·∫øu vi·ªác t·ª± ƒë·ªông ph√°t th·∫•t b·∫°i, ch√∫ng ta c·∫≠p nh·∫≠t n√∫t ƒë·ªÉ m·ªùi ng∆∞·ªùi d√πng t∆∞∆°ng t√°c.
                    isPlaying = false
                    toggleBtn.textContent = 'üé∂ B·∫≠t Nh·∫°c'
                    // Sau ƒë√≥, khi ng∆∞·ªùi d√πng nh·∫•n, h√†m click ·ªü tr√™n s·∫Ω g·ªçi playAudio()
                })
            })
        </script>
    </body>
</html>
